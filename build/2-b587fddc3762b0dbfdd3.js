(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{EBp5:function(e,t,n){"use strict";n.r(t);n("bAY4");var r=n("4IMT"),o=n.n(r),a=(n("Rbek"),n("MM9K")),i=n.n(a),c=(n("q5v/"),n("QpBz")),l=n.n(c),s=n("q1tI"),p=n.n(s),u=n("vDqi"),m=n.n(u),f=n("eO8H"),h=(n("FTNb"),n("UQ5x")),d=n("rOIg"),g=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={replyId:n.props.comment.id,upsLength:n.props.comment.ups.length},n.goodReply=n.goodReply.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,p.a.Component),g(t,[{key:"goodReply",value:function(){if(!d.a.isLogin())return l.a.error("请登录再进行操作"),!1;var e=h.a.GOOD_REPLY.replace("{replyId}",this.props.comment.id),t=this;m.a.post(e,{accesstoken:localStorage.getItem("userToken")}).then(function(e){"down"==e.data.action?t.setState({upsLength:t.state.upsLength-1}):t.setState({upsLength:t.state.upsLength+1})}).catch(function(e){l.a.error(e.response.data.error_msg)})}},{key:"render",value:function(){var e=this.props,t=e.comment,n=e.floor;return p.a.createElement("li",{className:"item"},p.a.createElement(f.b,{title:t.author.loginname,className:"float-left",to:"/user/"+t.author.loginname},p.a.createElement("img",{src:t.author.avatar_url})),p.a.createElement("div",{className:"item-content"},p.a.createElement("div",{className:"item-content-title"},p.a.createElement("span",null,t.author.loginname),p.a.createElement("span",{className:"comment-floor"},n+1,"楼")),p.a.createElement("div",{className:"item-content-body"},p.a.createElement("p",{dangerouslySetInnerHTML:{__html:t.content}})),p.a.createElement("div",{className:"item-content-meta"},p.a.createElement("span",{onClick:this.goodReply},p.a.createElement("i",{className:"iconfont icon-dianzan",title:"点赞数:"+this.state.upsLength}),this.state.upsLength),p.a.createElement("span",null,p.a.createElement("i",{className:"iconfont icon-huifu",title:"回复",onClick:this.addReply}),"回复"),p.a.createElement("span",null,p.a.createElement("i",{className:"iconfont icon-shijian",title:"创建时间:"+d.a.formatTime(t.create_at)}),d.a.formatTime(t.create_at)))))}}]),t}(),y=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var v=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,p.a.Component),y(t,[{key:"render",value:function(){var e=this.props.commentList;return p.a.createElement("ul",null,e&&e.map(function(e,t){return p.a.createElement(b,{key:t,comment:e,floor:t})}))}}]),t}(),E=n("j5fn"),_=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var w=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={topicId:n.props.match.params.id,topicInfo:{},loading:!0},n.getTopicDetail=n.getTopicDetail.bind(n),n.collectTopic=n.collectTopic.bind(n),n.publishRichText=n.publishRichText.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,p.a.Component),_(t,[{key:"getTopicDetail",value:function(e){this.setState({loading:!0});var t=h.a.GET_TOPIC_DETAIL.replace("{topicId}",this.state.topicId),n=this;m.a.get(t,{params:e}).then(function(e){n.setState({topicInfo:e.data.data,loading:!1})}).catch(function(e){n.setState({loading:!1}),l.a.error(e)})}},{key:"componentWillMount",value:function(){this.getTopicDetail({mdrender:"true",accesstoken:localStorage.getItem("userToken")})}},{key:"collectTopic",value:function(){var e=this;if(!d.a.isLogin())return l.a.error("请登录再进行操作"),!1;var t=this.state.topicInfo.is_collect?"DE_COLLECT_TOPIC":"COLLECT_TOPIC",n=h.a[t];m.a.post(n,{topic_id:this.state.topicId,accesstoken:localStorage.getItem("userToken")}).then(function(t){e.getTopicDetail({mdrender:"true",accesstoken:localStorage.getItem("userToken")})}).catch(function(e){l.a.error(e)})}},{key:"publishRichText",value:function(e){var t=this;if(!d.a.isLogin())return l.a.error("请登录再进行操作"),!1;var n=h.a.NEW_REPLY.replace("{topicId}",this.state.topicId);m.a.post(n,{accesstoken:localStorage.getItem("userToken"),content:e}).then(function(e){t.getTopicDetail({mdrender:"true",accesstoken:localStorage.getItem("userToken")})}).catch(function(e){l.a.error(e.response&&e.response.data.error_msg||"服务端出错")})}},{key:"render",value:function(){var e=this.state.topicInfo,t=this.state.topicInfo.is_collect;return this.state.loading?p.a.createElement(i.a,{tip:"正在加载...",size:"large"}):p.a.createElement("div",null,p.a.createElement("h3",{className:"block-title mt20"},p.a.createElement(f.b,{to:"/"},"首页"),p.a.createElement("span",{className:"bread-split"},"/"),"信息区"),e.title&&p.a.createElement("div",{className:"topic-detail-head"},p.a.createElement("h2",null,e.title),p.a.createElement(o.a,{type:"primary",style:{position:"absolute",right:"10px",top:"10px"},onClick:this.collectTopic},t?"取消收藏":"收藏"),p.a.createElement("p",null,p.a.createElement("span",null,"作者 : ",e.author.loginname),p.a.createElement("span",null,"创建时间 : ",d.a.formatTime(e.create_at)),p.a.createElement("span",null,"阅读数 : ",e.visit_count),p.a.createElement("span",null,"最近回复时间 : ",d.a.formatTime(e.last_reply_at)))),p.a.createElement("h3",{className:"block-title mt20"},"内容区"),p.a.createElement("div",{dangerouslySetInnerHTML:{__html:e.content},className:"md"}),p.a.createElement("h3",{className:"block-title mt20"},"回复区：共",e.reply_count,"条回复"),e.reply_count>0?p.a.createElement(v,{commentList:e.replies}):p.a.createElement("div",{className:"item",style:{lineHeight:"34px"}},"暂无回复"),p.a.createElement("h3",{className:"block-title mt20"},"添加回复"),p.a.createElement(E.a,{richTextSet:{height:260},publishRichText:this.publishRichText}))}}]),t}();t.default=w},FTNb:function(e,t,n){var r=n("GXaV");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("aET+")(r,o);r.locals&&(e.exports=r.locals)},GXaV:function(e,t,n){(e.exports=n("I1BE")(!1)).push([e.i,".item,\r\n.topic-detail-head {\r\n  position: relative;\r\n  padding: 10px;\r\n  border-top: 1px solid #eee;\r\n  background: #fff;\r\n  list-style: none;\r\n}\r\n.item:first-child {\r\n  border-top: none;\r\n}\r\n\r\n.item > a > img,\r\n.ava {\r\n  width: 40px;\r\n  height: 40px;\r\n  border-radius: 50%;\r\n  border: 1px solid #9e9e9e;\r\n}\r\n.ava {\r\n  vertical-align: middle;\r\n}\r\n.item > .item-content {\r\n  margin-left: 50px;\r\n}\r\n.item-content-title .comment-floor {\r\n  position: absolute;\r\n  right: 10px;\r\n  font-size: 14px;\r\n  color: #2a00ff;\r\n}\r\n.item-content-body {\r\n  margin-top: 10px;\r\n}\r\n.item-content-meta {\r\n  margin-top: 10px;\r\n}\r\n.item-content-meta span {\r\n  font-size: 14px;\r\n  margin-right: 10px;\r\n  cursor: pointer;\r\n}\r\n.item-content-meta span:hover {\r\n  color: #000;\r\n}\r\n\r\n.item-content-meta span > i {\r\n  margin-right: 4px;\r\n}\r\n.topic-detail-head > h2 {\r\n  font-size: 20px;\r\n  font-weight: 700;\r\n  margin-bottom: 20px;\r\n}\r\n.topic-detail-head > p > span {\r\n  margin-right: 15px;\r\n}\r\n\r\n/* 话题详情页 */\r\n.md {\r\n  background: #fff;\r\n  padding: 10px;\r\n  padding-left: 20px;\r\n}\r\n.md h1,\r\n.md h2,\r\n.md h3 {\r\n  border-bottom: 1px solid #eee;\r\n  line-height: 40px;\r\n}\r\n.md h1 {\r\n  font-size: 2em;\r\n  font-weight: 700;\r\n  margin: 0.67em 0em;\r\n}\r\n.md h2 {\r\n  font-size: 1.5em;\r\n  font-weight: 700;\r\n  margin: 0.83em 0em;\r\n}\r\n.md h3 {\r\n  font-size: 1.17em;\r\n  font-weight: 700;\r\n  margin: 1em 0em;\r\n}\r\n.md h4 {\r\n  font-size: 1em;\r\n  font-weight: 700;\r\n  margin: 1.33em 0em;\r\n}\r\n.md h5 {\r\n  font-size: 0.83em;\r\n  font-weight: 700;\r\n  margin: 1.33em 0em;\r\n}\r\n.md h6 {\r\n  font-size: 0.67em;\r\n  font-weight: 700;\r\n}\r\n.md p {\r\n  margin: 1em 0em;\r\n  font-size: 15px;\r\n  line-height: 1.7em;\r\n  overflow: auto;\r\n  white-space: pre-wrap;\r\n  word-wrap: break-word;\r\n}\r\n.md blockquote {\r\n  padding: 0 0 0 15px;\r\n  margin: 0 0 20px;\r\n  border-left: 5px solid #eee;\r\n}\r\n.md img {\r\n  height: auto;\r\n  max-width: 100%;\r\n  vertical-align: middle;\r\n  border: 0;\r\n}\r\n.md ul,\r\n.md ol {\r\n  margin: 1em 0em;\r\n  padding-left: 40px;\r\n}\r\n.md ul li,\r\n.md ol li {\r\n  display: list-item;\r\n  list-style: disc;\r\n  line-height: 2em;\r\n}\r\n",""])},j5fn:function(e,t,n){"use strict";n("bAY4");var r=n("4IMT"),o=n.n(r),a=n("q1tI"),i=n.n(a),c=n("lj4J"),l=n.n(c),s=(n("auUr"),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}),p=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.addReply=n.addReply.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.a.Component),p(t,[{key:"addReply",value:function(){var e=this.editorInstance.getContent("html");this.props.publishRichText(e),this.editorInstance.setContent("","html")}},{key:"render",value:function(){var e=this,t=this.props.richTextSet;return i.a.createElement("div",null,i.a.createElement("div",{className:"rich-text"},i.a.createElement(l.a,s({},t,{ref:function(t){return e.editorInstance=t}}))),i.a.createElement(o.a,{type:"primary",onClick:this.addReply,className:"mt20"},"回复"))}}]),t}();t.a=u}}]);